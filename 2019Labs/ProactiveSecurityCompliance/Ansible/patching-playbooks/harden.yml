---
- hosts: "{{ HOSTS }}"
  vars:
    ssh_banner: true
    sftp_enabled: true
    ssh_print_motd: true
    account_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          37336563333938313333393861346464323461663565303937333732316666613037363130643233
          3339663739653831313361636263396537356366623862650a626162613531383539636633643436
          65643164613663393237393130646436626561323231643338343863353162306263303661356161
          6438393537646364380a363164383966353262326639323563346661653232643132633033333164
          35373633656365353836303338613136643137633632326431303637636536613737353164656530
          61626530626431653532333361383461303637316266306436333262313163346365353936623661
          66643563303039306236353939343163306138663230633335366465333830613561336237663932
          63336166363537306261623331653433393639646237386464336339346566643966636236623633
          64373365356261646139373561363061326131333637303037623831333131636262

  pre_tasks:
  - name: Set ansible user password
    user:
      name: ansible
      group: ansible
      password: "{{ account_password }}"

  roles:
  - motd-splash
  - hardening
  - dev-sec.ssh-hardening

  tasks:
  - name: Link SSH Banner
    file:
      path: /etc/ssh/banner.txt
      src: /etc/issue
      state: link