---
- pamd:
    name: "{{ item }}"
    type: auth
    control: required
    module_path: pam_faillock.so
    module_arguments: "preauth silent audit deny={{ var_pass_max_attempts}} unlock_time={{ var_pass_unlock_time }}"
  loop:
    - system-auth
    - password-auth
 
- pamd:
    name: "{{ item }}"
    type: auth
    control: [default=die]
    module_path: pam_faillock.so
    module_arguments: "authfail audit deny={{ var_pass_max_attempts}} unlock_time={{ var_pass_unlock_time }}"
  loop:
    - system-auth
    - password-auth

- pamd:
    name: "{{ item }}"
    type: account
    control: required
    module_path: pam_faillock.so
  loop:
    - system-auth
    - password-auth